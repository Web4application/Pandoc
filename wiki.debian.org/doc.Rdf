<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article  PUBLIC '-//OASIS//DTD DocBook XML V4.4//EN'  'http://www.docbook.org/xml/4.4/docbookx.dtd'><article><articleinfo><title>LVM</title><revhistory><revision><revnumber>69</revnumber><date>2025-10-20 12:52:09</date><authorinitials>IgorTamara</authorinitials><revremark>Fixed translations link</revremark></revision><revision><revnumber>68</revnumber><date>2025-10-20 12:49:31</date><authorinitials>IgorTamara</authorinitials><revremark>Add tags for translation transclusion</revremark></revision><revision><revnumber>67</revnumber><date>2025-08-10 18:49:39</date><authorinitials>RichardLewis</authorinitials><revremark>Add to CategoryPermalink (mentioned in trixie releasenotes)</revremark></revision><revision><revnumber>66</revnumber><date>2025-07-26 15:47:20</date><authorinitials>RichardLewis</authorinitials><revremark>remove un-needed word</revremark></revision><revision><revnumber>65</revnumber><date>2025-07-26 15:45:19</date><authorinitials>RichardLewis</authorinitials><revremark>fix markup</revremark></revision><revision><revnumber>64</revnumber><date>2025-07-26 15:40:32</date><authorinitials>RichardLewis</authorinitials><revremark>Add text on resizing partitions</revremark></revision><revision><revnumber>63</revnumber><date>2025-07-26 15:23:19</date><authorinitials>RichardLewis</authorinitials><revremark>other proof-reading</revremark></revision><revision><revnumber>62</revnumber><date>2025-07-26 15:13:47</date><authorinitials>RichardLewis</authorinitials><revremark>edit VG section</revremark></revision><revision><revnumber>61</revnumber><date>2025-07-26 15:09:50</date><authorinitials>RichardLewis</authorinitials><revremark>editing PV section, - remove references to sudo, which is not enabled by default. try and be more consistent with the intro</revremark></revision><revision><revnumber>60</revnumber><date>2025-07-26 14:58:06</date><authorinitials>RichardLewis</authorinitials><revremark>remove reference to system-config package removed in 2017, and remove instructions for starting lvm on buster or earlier</revremark></revision><revision><revnumber>59</revnumber><date>2025-07-26 14:55:26</date><authorinitials>RichardLewis</authorinitials><revremark>delete reference to bug closed in 2015</revremark></revision><revision><revnumber>58</revnumber><date>2025-07-26 14:53:55</date><authorinitials>RichardLewis</authorinitials><revremark>reducing duplication and confusing wording in section on swap and encrypted LVM</revremark></revision><revision><revnumber>57</revnumber><date>2025-07-26 14:42:28</date><authorinitials>RichardLewis</authorinitials><revremark>reducing duplication and confusing wording in section on encrypted LVM</revremark></revision><revision><revnumber>56</revnumber><date>2025-07-26 14:14:34</date><authorinitials>RichardLewis</authorinitials><revremark>Remove some duplicate and confusing wording from the intro</revremark></revision><revision><revnumber>55</revnumber><date>2024-05-05 18:48:35</date><authorinitials>BoyuanYang</authorinitials><revremark>Fix typo as reported in #1070391</revremark></revision><revision><revnumber>54</revnumber><date>2024-03-10 15:49:14</date><authorinitials>Francewhoa</authorinitials><revremark>Added intro and summary to GUI title. Added licenses.</revremark></revision><revision><revnumber>53</revnumber><date>2024-03-10 15:42:15</date><authorinitials>Francewhoa</authorinitials><revremark>Updated features of GUI apps.</revremark></revision><revision><revnumber>52</revnumber><date>2024-03-10 05:41:39</date><authorinitials>Francewhoa</authorinitials><revremark>Removed link to Red Hat. As their &quot;Logical Volume Manager&quot; is no longer maintained and upgraded for Debian.</revremark></revision><revision><revnumber>51</revnumber><date>2024-03-10 05:38:04</date><authorinitials>Francewhoa</authorinitials></revision><revision><revnumber>50</revnumber><date>2024-03-10 05:36:50</date><authorinitials>Francewhoa</authorinitials><revremark>Added GUI title. With two options available for Debian: KDE PartitionManager &amp; Blivet-GUI.</revremark></revision><revision><revnumber>49</revnumber><date>2023-05-04 14:16:16</date><authorinitials>FilippoRusconi</authorinitials></revision><revision><revnumber>48</revnumber><date>2021-10-05 12:26:23</date><authorinitials>GarethDawson</authorinitials><revremark>adds missing sed command to rename boot volume example</revremark></revision><revision><revnumber>47</revnumber><date>2021-04-14 04:13:46</date><authorinitials>PaulWise</authorinitials><revremark>link to the cache_check manual page instead of listing the full path to the binary</revremark></revision><revision><revnumber>46</revnumber><date>2021-04-13 09:40:30</date><authorinitials>JeremyMcNaughton</authorinitials><revremark>thin-provisioning-tools required for cached volumes to be activated on boot</revremark></revision><revision><revnumber>45</revnumber><date>2021-03-28 13:45:58</date><authorinitials>PaulWise</authorinitials><revremark>deduplicate categories</revremark></revision><revision><revnumber>44</revnumber><date>2021-03-26 14:20:35</date><authorinitials>drbob</authorinitials><revremark>Updated /boot section as GRUB2 supports LVM</revremark></revision><revision><revnumber>43</revnumber><date>2020-10-26 01:44:36</date><authorinitials>PaulWise</authorinitials><revremark>update URLs for https and redirects</revremark></revision><revision><revnumber>42</revnumber><date>2020-10-26 01:41:29</date><authorinitials>PaulWise</authorinitials><revremark>modernise the apt installs</revremark></revision><revision><revnumber>41</revnumber><date>2020-10-26 01:40:52</date><authorinitials>PaulWise</authorinitials><revremark>typo</revremark></revision><revision><revnumber>40</revnumber><date>2020-10-26 01:38:46</date><authorinitials>PaulWise</authorinitials><revremark>link to the latest RH docs instead, clean up categories</revremark></revision><revision><revnumber>39</revnumber><date>2020-10-26 01:34:40</date><authorinitials>PaulWise</authorinitials><revremark>link to the RedHat LVM docs, they are quite useful</revremark></revision><revision><revnumber>38</revnumber><date>2020-10-25 12:54:21</date><authorinitials>DavidAyers</authorinitials><revremark>Add section demenstrating on renaming active volume groups.</revremark></revision><revision><revnumber>37</revnumber><date>2020-08-04 15:18:36</date><authorinitials>ValerioBozzolan</authorinitials><revremark>do not try to start lvm2 service in recent Debians</revremark></revision><revision><revnumber>36</revnumber><date>2019-11-22 17:46:54</date><authorinitials>leela52452</authorinitials><revremark>updated redirected URL of http://sources.redhat.com/lvm2/wiki/</revremark></revision><revision><revnumber>35</revnumber><date>2019-11-15 13:06:28</date><authorinitials>andrewsh</authorinitials></revision><revision><revnumber>34</revnumber><date>2019-09-14 22:19:56</date><authorinitials>nodiscc</authorinitials><revremark>add categories</revremark></revision><revision><revnumber>33</revnumber><date>2018-05-09 19:38:46</date><authorinitials>CalebJay</authorinitials><revremark>Changed improper &quot;loose&quot; to &quot;lose,&quot; as in &quot;lose your data.&quot; Lost data may indeed be loose, though ;)</revremark></revision><revision><revnumber>32</revnumber><date>2017-06-04 14:51:38</date><authorinitials>Diego Alonso</authorinitials><revremark>Named comands lists similarly for LVM, PV, VG, LV</revremark></revision><revision><revnumber>31</revnumber><date>2017-06-04 11:34:41</date><authorinitials>Diego Alonso</authorinitials><revremark>added spanish translation link</revremark></revision><revision><revnumber>30</revnumber><date>2017-05-19 02:45:42</date><authorinitials>Francewhoa</authorinitials><revremark>Added warning &amp; tip about restore backup passwords</revremark></revision><revision><revnumber>29</revnumber><date>2017-05-19 02:38:58</date><authorinitials>Francewhoa</authorinitials><revremark>Clarified &lt;slot&gt; parameter</revremark></revision><revision><revnumber>28</revnumber><date>2017-05-19 02:35:42</date><authorinitials>Francewhoa</authorinitials><revremark>Moved my note with other notes</revremark></revision><revision><revnumber>27</revnumber><date>2017-05-19 02:32:06</date><authorinitials>Francewhoa</authorinitials><revremark>Added important warning and tutorial about backup passwords</revremark></revision><revision><revnumber>26</revnumber><date>2017-04-10 00:05:05</date><authorinitials>Francewhoa</authorinitials><revremark>Add &quot;Encrypted LVM&quot; &amp; &quot;Encrypted LVM Swap Partition&quot; sections</revremark></revision><revision><revnumber>25</revnumber><date>2017-01-12 02:16:38</date><authorinitials>PaulWise</authorinitials><revremark>use the service script instead of init.d</revremark></revision><revision><revnumber>24</revnumber><date>2017-01-11 19:41:18</date><authorinitials>SalahuddinPasha</authorinitials></revision><revision><revnumber>23</revnumber><date>2016-02-05 16:30:51</date><authorinitials>MorganConlon</authorinitials><revremark>Spelling, d'Oh!</revremark></revision><revision><revnumber>22</revnumber><date>2016-02-05 16:28:44</date><authorinitials>MorganConlon</authorinitials><revremark>Clarify various definitions</revremark></revision><revision><revnumber>21</revnumber><date>2016-02-05 16:17:48</date><authorinitials>MorganConlon</authorinitials><revremark>Grammatical corrections, spellings and style.  Addition of sudo</revremark></revision><revision><revnumber>20</revnumber><date>2015-07-26 19:06:26</date><authorinitials>StefanEggers</authorinitials><revremark>adding description of how to remove a logical volume</revremark></revision><revision><revnumber>19</revnumber><date>2015-07-26 13:52:57</date><authorinitials>StefanEggers</authorinitials><revremark>adding description of how to remove a physical volume</revremark></revision><revision><revnumber>18</revnumber><date>2015-03-21 10:09:35</date><authorinitials>kao</authorinitials><revremark>Big update, need a review</revremark></revision><revision><revnumber>17</revnumber><date>2014-02-20 08:25:02</date><authorinitials>JeremyMcNaughton</authorinitials><revremark>fixed broken link to DebianBug:343671</revremark></revision><revision><revnumber>16</revnumber><date>2009-12-25 11:11:01</date><authorinitials>FranklinPiat</authorinitials><revremark>DebianBug</revremark></revision><revision><revnumber>15</revnumber><date>2009-06-23 21:45:12</date><authorinitials>DanielPocock</authorinitials></revision><revision><revnumber>14</revnumber><date>2009-05-21 19:12:42</date><authorinitials>FranklinPiat</authorinitials><revremark>Add link to upstream. drop link to debix.</revremark></revision><revision><revnumber>13</revnumber><date>2009-03-16 03:33:47</date><authorinitials>localhost</authorinitials><revremark>converted to 1.6 markup</revremark></revision><revision><revnumber>12</revnumber><date>2006-02-25 11:06:21</date><authorinitials>FilippoGiunchedi</authorinitials></revision><revision><revnumber>11</revnumber><date>2005-01-08 11:07:14</date><authorinitials>Unknown</authorinitials></revision><revision><revnumber>10</revnumber><date>2005-01-08 08:46:50</date><authorinitials>Unknown</authorinitials></revision><revision><revnumber>9</revnumber><date>2005-01-08 06:41:26</date><authorinitials>Unknown</authorinitials></revision><revision><revnumber>8</revnumber><date>2005-01-08 05:53:58</date><authorinitials>Unknown</authorinitials></revision><revision><revnumber>7</revnumber><date>2004-11-06 04:00:08</date><authorinitials>Unknown</authorinitials></revision><revision><revnumber>6</revnumber><date>2004-11-06 02:58:53</date><authorinitials>Unknown</authorinitials></revision><revision><revnumber>5</revnumber><date>2004-08-13 18:58:35</date><authorinitials>Unknown</authorinitials></revision><revision><revnumber>4</revnumber><date>2004-05-10 13:24:49</date><authorinitials>Unknown</authorinitials></revision><revision><revnumber>3</revnumber><date>2004-05-10 13:24:17</date><authorinitials>Unknown</authorinitials></revision><revision><revnumber>2</revnumber><date>2004-05-10 13:23:45</date><authorinitials>Unknown</authorinitials></revision><revision><revnumber>1</revnumber><date>2004-05-10 13:22:48</date><authorinitials>Unknown</authorinitials></revision></revhistory></articleinfo><informaltable><tgroup cols="2"><colspec colname="col_0"/><colspec colname="col_1"/><tbody><row rowsep="1"><entry colsep="1" rowsep="1"/><entry align="right" colsep="1" rowsep="1"><para> <inlinemediaobject><imageobject><imagedata depth="16" fileref="https://wiki.debian.org/htdocs/debwiki/img/idea.png" width="16"/></imageobject><textobject><phrase>(!)</phrase></textobject></inlinemediaobject> <ulink url="https://wiki.debian.org/LVM/LVM/Discussion#">Discussion</ulink></para></entry></row></tbody></tgroup></informaltable><para><link linkend="translation">Translation(s)</link>: <link linkend="">English</link> - <ulink url="https://wiki.debian.org/LVM/es/LVM#">Español</ulink> - <ulink url="https://wiki.debian.org/LVM/fr/LVM#">Français</ulink> - </para><!--rule (<hr>) is not applicable to DocBook--><para>LVM is a <emphasis role="strong">Logical Volume Manager</emphasis> for the Linux operating system. </para><section><title>Overview</title><para>Logical volume management with LVM provides a more flexible way to manage the disk space on a system than the traditional approach of dividing a disk into  partitions. LVM gives the system administrator much more flexibility in allocating storage, because partitions controlled by LVM be resized and moved  around, and a single partition can reside on more than one physical hard disk. </para><section><title>Definitions</title><itemizedlist><listitem><para><emphasis role="strong">PV</emphasis> : Physical Volumes.  This means a hard disk, hard disk partition, RAID or LUNs from a SAN. </para></listitem><listitem><para><emphasis role="strong">VG</emphasis> : Volume Groups.  This is a collection of one or more Physical Volumes. </para></listitem><listitem><para><emphasis role="strong">LV</emphasis> : Logical Volumes.  LVs sit inside a Volume Group and form, in effect, a virtual partition. </para></listitem><listitem><para><emphasis role="strong">PE</emphasis> : Physical Extents.  In order to manipulate the actual data, it is divided into blocks called <emphasis role="strong">P</emphasis>hysical <emphasis role="strong">E</emphasis>xtents. </para></listitem><listitem><para><emphasis role="strong">LE</emphasis> : Logical Extents.  Similar to Physical Extents, but at the Logical Volume level.  Physical Extents are to Physical Volumes as Logical Extents are to Logical Volumes.  The size of blocks are the same for each logical volume (LV) in the same volume group (VG). </para></listitem></itemizedlist><para>The most important terms for users are the PVs, VGs and LVs. </para><para>An example: </para><screen><![CDATA[||-------------------------OS----------------------------||
||-------------------------LVM---------------------------||
||  LV-1 (/)    |LV-2 (swap)|  LV 3 (/home) | LV-4 (/tmp)|| Logical Volumes (LV)
||------------------------------------------|------------||
||                  VG 1                    |    VG 2    || Volume Groups (VG)
||------------------------------------------|------------||
||  /dev/sda2 |    /dev/sda3    | /dev/sdb2 | /dev/sdd4  || Physical Volumes (PV)
||-------------------------------------------------------||]]></screen></section><section><title>Encrypted LVM</title><para>When formatting an LVM volume, you can choose whether to encrypt the data on it or not. Using encrypted LVM is recommended if you are worried about your  computer or disk storage being stolen. </para><para><inlinemediaobject><imageobject><imagedata depth="16" fileref="https://wiki.debian.org/htdocs/debwiki/img/attention.png" width="16"/></imageobject><textobject><phrase>&lt;!&gt;</phrase></textobject></inlinemediaobject> If you choose the encrypted LVM option, it is suggested to consider creating <link linkend="Backup_passwords">backup passwords</link> to ensure you can recover from data loss: Otherwise if you forget the password you will permanently lose all your valuable data <inlinemediaobject><imageobject><imagedata depth="16" fileref="https://wiki.debian.org/htdocs/debwiki/img/sad.png" width="16"/></imageobject><textobject><phrase>:(</phrase></textobject></inlinemediaobject> </para><section><title>Backing up passwords for encrypted LVM</title><para>Creating backup passwords is a two step process. First you create a backup password and then you back them up. </para><orderedlist numeration="arabic"><listitem><para>Add backup passwords </para></listitem></orderedlist><para>Run the following command as root: </para><screen><![CDATA[cryptsetup luksChangeKey <device> -S <key-slot>]]></screen><para>Notes </para><itemizedlist><listitem><para>The <emphasis role="strong"><code>-S</code></emphasis> option specifies a <emphasis role="strong"><code>&lt;key-slot&gt;</code></emphasis> (number from 0 to 7) holding a password. You need to replace <emphasis role="strong"><code>&lt;device&gt;</code></emphasis> with the path to your encrypted LVM volume. For example <emphasis role="strong"><code>/dev/sda</code></emphasis>. </para></listitem><listitem><para>It is suggested to create at least 3 backup passwords. To add an additional backup password simply run the same command, but change the <emphasis role="strong"><code>&lt;key-slot&gt;</code></emphasis> number. For example to set the password in slot 2 use: </para></listitem></itemizedlist><screen><![CDATA[cryptsetup luksChangeKey /dev/sda -S 2]]></screen><itemizedlist><listitem><para>The password(s) of a encrypted LVM volume are stored inside its Linux Unified Key Setup (LUKS) header. </para></listitem></itemizedlist><orderedlist numeration="arabic"><listitem><para>Back up the passwords </para></listitem></orderedlist><para>Run the following command as root: </para><screen><![CDATA[cryptsetup luksHeaderBackup <device> --header-backup-file <file>]]></screen><para>Notes </para><itemizedlist><listitem><para><emphasis role="strong"><code>&lt;device&gt;</code></emphasis> is the location to save your backup to, for example <emphasis role="strong"><code>/dev/sda</code></emphasis>. And <emphasis role="strong">&lt;file&gt;</emphasis> is the name of your backup file, for example <emphasis role="strong"><code>/media/jenn/2017-05-18_luks_sda_backup</code></emphasis>. This command backs up the passwords in all eight key-slots. </para></listitem><listitem><para>It is suggested to store the backup file in a secure, off-line, and different location to ensure that you can access them if you lose access to LVM volume. </para></listitem><listitem><para>See the official <ulink url="https://gitlab.com/cryptsetup/cryptsetup/wikis/FrequentlyAskedQuestions#6-backup-and-data-recovery">LUKS wiki documentation</ulink> for more information </para></listitem></itemizedlist></section><section><title>Restore passwords</title><orderedlist numeration="arabic"><listitem><para>Restore passwords from backup </para><itemizedlist><listitem override="none"><para>Run the following command as root </para></listitem></itemizedlist></listitem></orderedlist><screen><![CDATA[cryptsetup luksHeaderRestore <device> --header-backup-file <file>]]></screen><itemizedlist><listitem override="none"><para>Notes </para><itemizedlist><listitem><para><inlinemediaobject><imageobject><imagedata depth="16" fileref="https://wiki.debian.org/htdocs/debwiki/img/attention.png" width="16"/></imageobject><textobject><phrase>&lt;!&gt;</phrase></textobject></inlinemediaobject> This command will delete <emphasis>all</emphasis> eight passwords, then restore <emphasis>all</emphasis> your backed up passwords. Before running this command, you should double check that you are sure you really want to proceed: there is no undo <inlinemediaobject><imageobject><imagedata depth="16" fileref="https://wiki.debian.org/htdocs/debwiki/img/smile4.png" width="16"/></imageobject><textobject><phrase>;)</phrase></textobject></inlinemediaobject> </para></listitem><listitem><para>You need to change <emphasis role="strong"><code>&lt;device&gt;</code></emphasis> to the path to your encrypted LVM volume, for example <emphasis role="strong"><code>/dev/sda</code></emphasis>. You need to change <emphasis role="strong">&lt;file&gt;</emphasis> to the path to your backup file, for example <emphasis role="strong"><code>/media/jenn/2017-05-18_luks_sda_backup</code></emphasis>. </para></listitem><listitem><para>See the official <ulink url="https://gitlab.com/cryptsetup/cryptsetup/wikis/FrequentlyAskedQuestions#6-backup-and-data-recovery">LUKS wiki documentation</ulink> for more information </para></listitem></itemizedlist></listitem></itemizedlist></section><section><title>Using Encrypted LVM as a swap partition</title><para>If you use encrypted LVM partitions then you will probably want to encrypt your swap partition as well, because the LVM encryption key is stored in memory and may be written to swap: anyone with physical access may be able to retrieve the encryption keys for all encrypted partitions by accessing the swap partition. The Debian installer will warn against creating an LVM encrypted partition unless the swap partition is encrypted (see <ulink url="https://debian-handbook.info/browse/stable/sect.installation-steps.html">Source</ulink>) </para></section></section><section><title>Labels</title><para>You should use labels for Logical Volume (LV) identification in <code>/etc/fstab</code>, instead of UUIDs or the kernel naming rules (/dev/sda) in order to avoid conflicts with the restoration of volume snapshots. </para></section><section><title>/boot</title><para><ulink url="https://wiki.debian.org/LVM/Grub#">Grub</ulink> v2 supports booting from an LVM partition since <ulink url="https://wiki.debian.org/LVM/DebianSqueeze#">DebianSqueeze</ulink>.  </para><para>If you plan to encrypt your root filesystem <code>/boot</code> may need to be located in a separate, unencrypted, Logical Volume or partition. Refer to the <ulink url="https://wiki.debian.org/LVM/Cryptsetup#">Cryptsetup</ulink> documentation for more information.   </para><para>GRUB v1 and <ulink url="https://wiki.debian.org/LVM/LILO#">LILO</ulink> were not compatible with LVM, if you use one of those legacy bootloaders <code>/boot</code> could not be on the storage disk managed by LVM.  </para></section><section><title>LVM cached volumes</title><para>To use <ulink url="https://manpages.debian.org/man/7/lvmcache#">lvmcache(7)</ulink> your system must have the <ulink url="https://packages.debian.org/thin-provisioning-tools#">thin-provisioning-tools</ulink> installed for its <ulink url="https://manpages.debian.org/man/cache_check#">cache_check</ulink> tool, otherwise cached volumes will not be available at boot.  This could result in the system being unbootable without manual intervention. </para></section></section><section><title>Installation</title><para>All tools to manage an LVM volume are available in the <ulink url="https://packages.debian.org/lvm2#">lvm2</ulink> package which can be installed by running </para><screen><![CDATA[apt install lvm2]]></screen><section><title>List of LVM commands</title><itemizedlist><listitem><para><emphasis role="strong">lvmchange</emphasis> — Change attributes of the Logical Volume Manager. </para></listitem><listitem><para><emphasis role="strong">lvmdiskscan</emphasis> — Scan for all devices visible to LVM2. </para></listitem><listitem><para><emphasis role="strong">lvmdump</emphasis> — Create lvm2 information dumps for diagnostic purposes. </para></listitem></itemizedlist></section></section><section><title>Physical Volumes (PV)</title><section><title>Create a PV</title><para>To add a hard disk or partition, such as <code>/dev/sda2</code>, to LVM, you create a physical volume, by running the following as root: </para><screen><![CDATA[pvcreate /dev/sda2]]></screen><para>You can now add this PV to a volume group (or create a new VG, see below). </para></section><section><title>Remove a PV</title><para>In order to remove a physical disk from LVM Physical Volume (PV) all data must first be moved off it.  To do this, make sure any other physical volumes in the same volume group have enough free space and then issue this command as root: </para><screen><![CDATA[pvmove /dev/sda2]]></screen><para>After the data is moved, remove the disk from the volume group. Assuming the VG is named <code>vol-group</code>, run the following as root: </para><screen><![CDATA[vgreduce vol-group /dev/sda2]]></screen><para>And finally remove the PV by running this as root: </para><screen><![CDATA[pvremove /dev/sda2]]></screen></section><section><title>List of PV commands</title><itemizedlist><listitem><para><emphasis role="strong">pvchange</emphasis> — Change attributes of a Physical Volume. </para></listitem><listitem><para><emphasis role="strong">pvck</emphasis> — Check Physical Volume metadata. </para></listitem><listitem><para><emphasis role="strong">pvcreate</emphasis> — Initialize a disk or partition for use by LVM. </para></listitem><listitem><para><emphasis role="strong">pvdisplay</emphasis> — Display attributes of a Physical Volume. </para></listitem><listitem><para><emphasis role="strong">pvmove</emphasis> — Move Physical Extents. </para></listitem><listitem><para><emphasis role="strong">pvremove</emphasis> — Remove a Physical Volume. </para></listitem><listitem><para><emphasis role="strong">pvresize</emphasis> — Resize a disk or partition in use by LVM2. </para></listitem><listitem><para><emphasis role="strong">pvs</emphasis> — Report information about Physical Volumes. </para></listitem><listitem><para><emphasis role="strong">pvscan</emphasis> — Scan all disks for Physical Volumes. </para></listitem></itemizedlist></section></section><section><title>Volume Groups (VG)</title><section><title>Create a volume group</title><para>Assuming <code>/dev/sda2</code> has been set up as an LVM Physical volume, root can add it to a new volume group by running: </para><screen><![CDATA[vgcreate myVirtualGroup1 /dev/sda2]]></screen></section><section><title>Extend a volume group</title><para>A volume group can contian multiple physical volumes: after running </para><screen><![CDATA[pvcreate /dev/sda3]]></screen><para>you can add the new PV to an existing VG that already exists: </para><screen><![CDATA[vgextend VG /dev/sda3]]></screen></section><section><title>Renaming a volume group</title><para>Renaming a volume group can be tricky if it contains the root or swap partition.  In that case it should be insured that the old names are still accessible via /dev/mapper until a full reboot cycle is complete. </para><screen><![CDATA[vgrename somename-vg vgsomename
cd /dev/mapper
ls somename-vg*
## somename--vg-lv1
## somename--vg-lv2
...
]]><![CDATA[
ln -s vgsomename-lv1   somename--vg-lv1
ln -s vgsomename-lv2   somename--vg-lv2
...
]]><![CDATA[
# if logical volumes of the group are contained in /etc/fstab:
sed -i 's#/dev/mapper/somename--vg-#/dev/vgsomename/#g' /etc/fstab
]]><![CDATA[
# if logical volumes of the group are contained in /boot/grub/grub.cfg:
sed -i 's#/dev/mapper/somename--vg-#/dev/vgsomename/#g' /boot/grub/grub.cfg  # this is only good for the initramfs run and the initial next reboot
update-initramfs -c -k all
]]><![CDATA[
reboot
update-grub #creating final /boot/grub/grub.cfg]]></screen></section><section><title>List VGs</title><para>Simply run this command: </para><screen><![CDATA[vgdisplay]]></screen></section><section><title>List of VG commands</title><itemizedlist><listitem><para><emphasis role="strong">vgcfgbackup</emphasis> — Backup Volume Group descriptor area. </para></listitem><listitem><para><emphasis role="strong">vgcfgrestore</emphasis> — Restore Volume Group descriptor area. </para></listitem><listitem><para><emphasis role="strong">vgchange</emphasis> — Change attributes of a Volume Group. </para></listitem><listitem><para><emphasis role="strong">vgck</emphasis> — Check Volume Group metadata. </para></listitem><listitem><para><emphasis role="strong">vgconvert</emphasis> — Convert Volume Group metadata format. </para></listitem><listitem><para><emphasis role="strong">vgcreate</emphasis> — Create a Volume Group. </para></listitem><listitem><para><emphasis role="strong">vgdisplay</emphasis> — Display attributes of Volume Groups. </para></listitem><listitem><para><emphasis role="strong">vgexport</emphasis> — Make volume Groups unknown to the system. </para></listitem><listitem><para><emphasis role="strong">vgextend</emphasis> — Add Physical Volumes to a Volume Group. </para></listitem><listitem><para><emphasis role="strong">vgimport</emphasis> — Make exported Volume Groups known to the system. </para></listitem><listitem><para><emphasis role="strong">vgimportclone</emphasis> — Import and rename duplicated Volume Group (e.g. a hardware snapshot). </para></listitem><listitem><para><emphasis role="strong">vgmerge</emphasis> — Merge two Volume Groups. </para></listitem><listitem><para><emphasis role="strong">vgmknodes</emphasis>  — Recreate Volume Group directory and Logical Volume special files </para></listitem><listitem><para><emphasis role="strong">vgreduce</emphasis> — Reduce a Volume Group by removing one or more Physical Volumes. </para></listitem><listitem><para><emphasis role="strong">vgremove</emphasis> — Remove a Volume Group. </para></listitem><listitem><para><emphasis role="strong">vgrename</emphasis> — Rename a Volume Group. </para></listitem><listitem><para><emphasis role="strong">vgs</emphasis> — Report information about Volume Groups. </para></listitem><listitem><para><emphasis role="strong">vgscan</emphasis> — Scan all disks for Volume Groups and rebuild caches. </para></listitem><listitem><para><emphasis role="strong">vgsplit</emphasis> — Split a Volume Group into two, moving any logical volumes from one Volume Group to another by moving entire Physical Volumes. </para></listitem></itemizedlist></section></section><section><title>Logical Volumes (LV)</title><section><title>Create an LV</title><para><inlinemediaobject><imageobject><imagedata depth="16" fileref="https://wiki.debian.org/htdocs/debwiki/img/attention.png" width="16"/></imageobject><textobject><phrase>&lt;!&gt;</phrase></textobject></inlinemediaobject> Don't forget to check that you have enough space: naturally, an LV of 100 GB does not work if you only have 10 GB of space. Use <code>vgdisplay</code> to see the free space in each volume group. All these commands must be run as root. </para><para>Create a logical volume in a volume group: </para><screen><![CDATA[lvcreate --name myLogicalVolume1 --size 10g myVirtualGroup1]]></screen><para>Create a filesystem on the logical volume: </para><screen><![CDATA[mkfs -t ext4 /dev/myVirtualGroup1/myLogicalVolume1]]></screen><para>You can test to see if it's working: </para><screen>
	
	<![CDATA[mkdir /test
sudo mount /dev/myVirtualGroup1/myLogicalVolume1 /test
df -h]]></screen><para>You can list your logical volumes with: </para><screen><![CDATA[sudo lvdisplay]]></screen></section><section><title>Remove a LV</title><para>To remove a logical volume, make sure it is not in use.  Then simply issue this command to remove the logical volume myLogicalVolume1 in volume group myVirtualGroup1: </para><screen><![CDATA[lvremove myVirtualGroup1/myLogicalVolume1]]></screen></section><section><title>Increase the size of a partition using LVM</title><para>To increase the size of a partition, such as <code>/boot</code> stored in a logical volume <code>/dev/vg/boot</code> of a volume group <code>vg</code> that has some unused space: </para><screen><![CDATA[lvextend --resizefs --verbose --size +3G /dev/vg/boot]]></screen><para>This can be done with the partition still mounted. If you do not have free space in the volume group you will need to shrink one of the other LVs in the VG or add another physical volume.  </para></section><section><title>Shrinking a partition using LVM</title><para>To shrink a partition, such as <code>/tmp</code> stored on a logical volume <code>/dev/vg/tmp</code> of a volume group <code>vg</code>  </para><screen><![CDATA[lvreduce --resizefs --verbose --size -1G /dev/vg/tmp]]></screen><para>This assumes there was 1GB of unused space on the partition. The commmand will unmount the partition and remount it when finished: you will need to ensure nothing is using the filesystem before starting (for the root partition you may need to boot into a rescue disk and resize from there) </para></section><section><title>List of LV commands</title><itemizedlist><listitem><para><emphasis role="strong">lvchange</emphasis> — Change attributes of a Logical Volume. </para></listitem><listitem><para><emphasis role="strong">lvconvert</emphasis> — Convert a Logical Volume from linear to mirror or snapshot. </para></listitem><listitem><para><emphasis role="strong">lvcreate</emphasis> — Create a Logical Volume in an existing Volume Group. </para></listitem><listitem><para><emphasis role="strong">lvdisplay</emphasis> — Display the attributes of a Logical Volume. </para></listitem><listitem><para><emphasis role="strong">lvextend</emphasis> — Extend the size of a Logical Volume. </para></listitem><listitem><para><emphasis role="strong">lvreduce</emphasis> — Reduce the size of a Logical Volume. </para></listitem><listitem><para><emphasis role="strong">lvremove</emphasis> — Remove a Logical Volume. </para></listitem><listitem><para><emphasis role="strong">lvrename</emphasis> — Rename a Logical Volume. </para></listitem><listitem><para><emphasis role="strong">lvresize</emphasis> — Resize a Logical Volume. </para></listitem><listitem><para><emphasis role="strong">lvs</emphasis> — Report information about Logical Volumes. </para></listitem><listitem><para><emphasis role="strong">lvscan</emphasis> — Scan (all disks) for Logical Volumes. </para></listitem></itemizedlist></section></section><section><title>Graphical applications for managing LVM</title><para>Below are applications with a graphical user interface (GUI) that allows you to manage LVM devices </para><section><title>KDE PartitionManager</title><itemizedlist><listitem><para>To install, get this KDE <ulink url="https://packages.debian.org/partitionmanager#">partitionmanager</ulink> package </para></listitem><listitem><para>Supports LVM2, PV, VG, LV, LUKS encryption, and others  </para></listitem><listitem><para>Code repository at <ulink url="https://github.com/KDE/partitionmanager/"/> </para></listitem><listitem><para>Libre Source (Open Source) with LGPL 3, GPL 4, GFDL 1.2, CCO 1, CC-BY 4 licences </para></listitem></itemizedlist></section><section><title>Blivet-GUI</title><itemizedlist><listitem><para>To install, click on the &quot;Debian&quot; button at <ulink url="https://software.opensuse.org/download.html?project=home:vtrefny&amp;package=blivet-gui"/> Then choose an installation option. </para></listitem><listitem><para>Available for Debian 10 or 11 </para></listitem><listitem><para>Support LVM2, PV, VG, LV, and others  </para></listitem><listitem><para>Code repository at <ulink url="https://github.com/storaged-project/blivet-gui/"/> </para></listitem><listitem><para>Libre Source (Open Source) with GPL 2 licence </para></listitem></itemizedlist></section></section><section><title>See also:</title><itemizedlist><listitem><para>Comparison of <ulink url="https://wiki.debian.org/LVM/Linux%20volume%20management#">Linux volume management</ulink> solutions for Debian users </para></listitem><listitem><para><ulink url="https://tldp.org/HOWTO/LVM-HOWTO"/> </para></listitem><listitem><para>Upstream: </para><itemizedlist><listitem><para><ulink url="https://sourceware.org/lvm2/"/> - Homepage, mailing list, IRC... </para></listitem><listitem><para><ulink url="https://sourceware.org/lvm2/wiki/"/> - Wiki </para></listitem></itemizedlist></listitem></itemizedlist><!--rule (<hr>) is not applicable to DocBook--><para> <ulink url="https://wiki.debian.org/LVM/CategorySystemAdministration#">CategorySystemAdministration</ulink> | <ulink url="https://wiki.debian.org/LVM/CategoryStorage#">CategoryStorage</ulink> | <ulink url="https://wiki.debian.org/LVM/CategoryPermalink#">CategoryPermalink</ulink>: mentioned in the <ulink url="https://www.debian.org/releases/trixie/release-notes/issues.en.html#ensure-boot-has-enough-free-space">Release Notes for trixie</ulink>
</para></section></article>
